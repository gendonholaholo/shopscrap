# ============================================================================
# Shopee Scraper - Environment Configuration
# Copy this file to .env and fill in your values
# ============================================================================

# =========================
# GENERAL SETTINGS
# =========================
# Environment: development | production
# - development: Auth disabled, rate limit disabled, debug errors shown
# - production: Auth REQUIRED, rate limit enabled, errors hidden
SHOPEE_ENV=development
SHOPEE_DEBUG=false  # Enable debug mode (shows detailed errors)

# =========================
# SHOPEE CREDENTIALS
# =========================
# Optional - for authenticated scraping
SHOPEE_EMAIL=
SHOPEE_PASSWORD=
SHOPEE_PHONE=

# =========================
# RATE LIMITING (API)
# =========================
# Toggle rate limiting on/off
RATE_LIMIT_ENABLED=false  # Set to true in production!

# Limits
RATE_LIMIT_REQUESTS_PER_MINUTE=60   # Max requests per minute per IP
RATE_LIMIT_REQUESTS_PER_HOUR=1000   # Max requests per hour per IP
RATE_LIMIT_BURST_LIMIT=10           # Burst allowance

# Storage backend for rate limiting
RATE_LIMIT_STORAGE=memory           # memory | redis
RATE_LIMIT_REDIS_URL=redis://localhost:6379/0  # Redis DB 0 for rate limiting

# =========================
# CORS CONFIGURATION
# =========================
# Toggle CORS on/off
CORS_ENABLED=true

# Allowed origins (comma-separated, use * for all)
# Development: *
# Production: https://yourdomain.com,https://app.yourdomain.com
CORS_ALLOW_ORIGINS=*

# Allowed HTTP methods (comma-separated)
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS

# Allowed headers (comma-separated, use * for all)
CORS_ALLOW_HEADERS=*

# Allow credentials (cookies, auth headers)
# WARNING: Cannot be true if CORS_ALLOW_ORIGINS=*
CORS_ALLOW_CREDENTIALS=false

# Preflight cache max age (seconds)
CORS_MAX_AGE=600

# =========================
# API AUTHENTICATION
# =========================
# NOTE: In Docker production (docker-compose.yml), this defaults to TRUE
# Only set to false for local development
API_AUTH_ENABLED=false

# API Keys (comma-separated)
# Generate keys using: python -c "import secrets; print(f'sk_{secrets.token_hex(24)}')"
# Example: sk_a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6
API_KEYS=

# Header name for API key (default: X-API-Key)
API_KEY_HEADER_NAME=X-API-Key

# =========================
# PROXY CONFIGURATION
# =========================
PROXY_ENABLED=false
PROXY_TYPE=residential  # residential | datacenter | mobile
PROXY_HOST=
PROXY_PORT=
PROXY_USERNAME=
PROXY_PASSWORD=

# =========================
# BROWSER SETTINGS
# =========================
HEADLESS=true
BROWSER_TIMEOUT=30000  # milliseconds

# =========================
# DATABASE (Optional)
# =========================
DB_ENABLED=false
DB_HOST=localhost
DB_PORT=5432
DB_USER=shopee
DB_PASSWORD=shopee_secret
DB_NAME=shopee_data

# =========================
# REDIS (Required for API)
# =========================
# Used for rate limiting, job queue, and caching
REDIS_HOST=localhost
REDIS_PORT=6379

# =========================
# JOB QUEUE (Redis-backed)
# =========================
# Uses Redis DB 1 (separate from rate limiter on DB 0)
JOB_QUEUE_REDIS_URL=redis://localhost:6379/1
JOB_QUEUE_MAX_CONCURRENT=3                  # Max parallel workers
JOB_QUEUE_JOB_TTL_HOURS=24                  # Auto-expire completed jobs (hours)
JOB_QUEUE_MAX_RETRIES=3                     # Retry attempts on failure
JOB_QUEUE_RETRY_DELAY_SECONDS=5             # Base delay between retries (exponential backoff)
JOB_QUEUE_HANDLER_TIMEOUT_SECONDS=3600      # Max execution time per job (1 hour)
JOB_QUEUE_MAX_QUEUE_SIZE=100                # Max pending jobs (rejects when full â†’ HTTP 429)
JOB_QUEUE_CLEANUP_INTERVAL_SECONDS=3600     # Interval between expired job cleanup

# =========================
# ANTI-CAPTCHA (Optional)
# =========================
USE_ANTICAPTCHA=false  # Enable 2Captcha auto-solving
TWOCAPTCHA_API_KEY=    # Get API key from https://2captcha.com

# =========================
# LOGGING
# =========================
LOG_LEVEL=INFO  # DEBUG | INFO | WARNING | ERROR
LOG_FORMAT=json # json | text

# =========================
# OUTPUT
# =========================
OUTPUT_DIR=./data/output
OUTPUT_FORMAT=json  # json | csv | both
